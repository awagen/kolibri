kolibri {
  actor-system = "KolibriApp"
  request {
    parallelism = 32
    useTracking = false
    useConnectionPoolFlow = false
    connection.pool.mode = "STANDARD"
    connection.pool.mode = ${?CONNECTION_POOL_MODE}
    connection.pool.moduleClass = ""
    connection.pool.moduleClass = ${?CONNECTION_POOL_MODULE_CLASS}
    responseToStrictTimeoutInMs = 3000
    responseToStrictTimeoutInMs = ${?RESPONSE_TO_STRICT_TIMEOUT_IN_MS}
    target {
      allowedHosts = "*"
      allowedHosts = ${?TARGET_ALLOWED_HOSTS}
      allowedPorts = "*"
      allowedPorts = ${?TARGET_ALLOWED_PORTS}
      allowedContextPaths = "*"
      allowedContextPaths = ${?TARGET_ALLOWED_CONTEXT_PATH}
    }
  }
  job {
   batchStateUpdateInitialDelayInSeconds = 2
   batchStateUpdateIntervalInSeconds = 10
   processingCheckResourcesIntervalInMillis = 100
   runningTasksPerJobMaxCount = 5
   runningTasksPerJobDefaultCount = 2
   batchDistributionIntervalInMs = 1000
   batchMaxTimeToACKInMs = 1000
   allowedTimePerElementInMillis = 2000
   allowedTimePerBatchInSeconds = 1200
   allowedTimePerJobInSeconds = 14400
   resources {
     directives {
       maxLoadTimeInMinutes = 5
       maxLoadTimeInMinutes = ${?MAX_RESOURCE_DIRECTIVES_LOAD_TIME_IN_MINUTES}
     }
     judgements {
       topKJudgementsPerQueryStorageSize = 100
     }
   }
   tasks {
     waitForSynchronousTaskCompleteInMs = 100
   }
  }
  cluster {
    statusCheckTimeoutInMillis = 1000
    startClusterSingletonRouter = false
  }
  supervisor {
    maxNumOfRetries = 3
    maxNumOfRetriesWithinTimeInSeconds = 60
    houseKeepingIntervalInSeconds = 10
  }
  execution {
    runnableExecutionHouseKeepingIntervalInSeconds = 10
    runnableExecutionHouseKeepingIntervalInSeconds = ${?RUNNABLE_EXECUTION_HOUSEKEEPING_INTERVAL_IN_S}
    aggregatingActorHouseKeepingIntervalInSeconds = 10
    aggregatingActorHouseKeepingIntervalInSeconds = ${?AGGREGATING_ACTOR_HOUSEKEEPING_INTERVAL_IN_S}
    aggregatingActorStateSendingIntervalInSeconds = 2
    aggregatingActorStateSendingIntervalInSeconds = ${?AGGREGATING_ACTOR_STATE_SENDING_INTERVAL_IN_S}
    workManagerStateUpdateIntervalInSeconds = 2
    workManagerStateUpdateIntervalInSeconds = ${?WORK_MANAGER_STATE_UPDATE_INTERVAL_IN_S}
    workManagerReportBatchStateToJobManagerIntervalInSeconds = 2
    workManagerReportBatchStateToJobManagerIntervalInSeconds = ${?WORK_MANAGER_REPORT_BATCH_STATE_INTERVAL_IN_S}
    jobManagerCheckForCompletionIntervalInSeconds = 5
    jobManagerCheckForCompletionIntervalInSeconds = ${?JOB_MANAGER_CHECK_FOR_COMPLETION_INTERVAL_IN_S}
    useAggregatorBackpressure = true
    aggregatorResultReceiveParallelism = 200
    useResultElementGrouping = true
    resultElementGroupingCount = 500
    resultElementGroupingIntervalInMs = 500
    resultElementGroupingParallelism = 1
    maxNrBatchRetries = 2
  }
  format {
    metricDocumentFormatTypes = "csv,json"
    metricDocumentFormatTypes = ${?METRIC_DOCUMENT_FORMAT_TYPES}
    judgements {
      sourceType = "CSV"
      judgementKeyQueryAndProductDelimiter = "\u0000"
      jsonLines {
        queryPath = "query"
        queryPath = ${?JUDGEMENT_FILE_JSON_LINES_QUERY_PATH}
        productsPath = "products"
        productsPath = ${?JUDGEMENT_FILE_JSON_LINES_PRODUCTS_PATH}
        productIdSelector = "productId"
        productIdSelector = ${?JUDGEMENT_FILE_JSON_LINES_PRODUCT_ID_SELECTOR}
        judgementSelector = "score"
        judgementSelector = ${?JUDGEMENT_FILE_JSON_LINES_JUDGEMENT_SELECTOR}
        judgementValueTypeCast = "DOUBLE"
        judgementValueTypeCast = ${?JUDGEMENT_FILE_JSON_LINES_JUDGEMENT_VALUE_TYPE_CAST}
      }
      csv {
        judgementFileColumnDelimiter = "\u0000"
        judgementFileColumnDelimiter = ${?JUDGEMENT_FILE_COLUMN_DELIMITER}
        judgementFileIgnoreLessThanColumns = 3
        judgementFileIgnoreLessThanColumns = ${?JUDGEMENT_FILE_IGNORE_LESS_THAN_COLUMNS}
        judgementFileJudgementColumn = 2
        judgementFileJudgementColumn = ${?JUDGEMENT_FILE_JUDGEMENT_COLUMN}
        judgementFileSearchTermColumn = 0,
        judgementFileSearchTermColumn = ${?JUDGEMENT_FILE_SEARCH_TERM_COLUMN}
        judgementFileProductIdColumn = 1
        judgementFileProductIdColumn = ${?JUDGEMENT_FILE_PRODUCT_ID_COLUMN}
      }
    }
  }
  persistence {
    mode = "CLASS"
    mode = ${?PERSISTENCE_MODE}
    moduleClass = "de.awagen.kolibri.fleet.akka.config.di.modules.persistence.LocalPersistenceModule"
    moduleClass = ${?PERSISTENCE_MODULE_CLASS}
    directoryPathSeparator = "/"
    directoryPathSeparator = ${?DIRECTORY_PATH_SEPARATOR}
    csvColumnSeparator = "\t"
    csvColumnSeparator = ${?CSV_COLUMN_SEPARATOR}
    local {
      writeBasePath = ""
      writeBasePath = ${?LOCAL_STORAGE_WRITE_BASE_PATH}
      writeResultsSubPath = ""
      writeResultsSubPath = ${?LOCAL_STORAGE_WRITE_RESULTS_SUBPATH}
      readBasePath = ""
      readBasePath = ${?LOCAL_STORAGE_READ_BASE_PATH}
      resources {
        readBasePath = ""
        readBasePath = ${?LOCAL_RESOURCES_READ_BASE_PATH}
      }
    }
    templates {
      jobTemplatesPath = ${?JOB_TEMPLATES_PATH}
    }
    inputs {
      dataPath = ${?INPUT_DATA_PATH}
    }
    outputs {
      resultsPath = ${?OUTPUT_RESULTS_PATH}
    }
  }
  internal {
    jobStatusRequestTimeoutInSeconds = 3
    analyzeTimeoutInSeconds = 30
  }
  ssl {
    useInsecureEngine = false
    useInsecureEngine = ${?USE_INSECURE_SSL_ENGINE}
  }
  state {
    useShardingAndEndpoints = false
    useShardingAndEndpoints = ${?USE_SHARDING_AND_ENDPOINTS}
  }
}
